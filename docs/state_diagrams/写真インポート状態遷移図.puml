@startuml 写真インポート状態遷移図

title 写真インポート処理 - 状態遷移図

[*] --> 待機中

state 待機中 {
  [*] --> メイン表示
}

待機中 --> メタデータ解析中 : 写真を追加ボタンを押下し、写真をドラッグ＆ドロップ

state "写真インポート処理" as PhotoImport {
  
  state メタデータ解析中 {
    [*] --> 解析実行
    解析実行 --> VRChatAPI問い合わせ中 : World IDあり
    解析実行 --> エラー状態 : World IDなし
  }

  state VRChatAPI問い合わせ中 {
    [*] --> APIリクエスト
    APIリクエスト --> DB保存中 : 成功
    APIリクエスト --> エラー状態 : 失敗
  }

  state DB保存中 {
    [*] --> 重複チェック
    重複チェック --> 保存完了 : 新規または追加
  }

  state エラー状態 {
    [*] --> エラーメッセージ表示
  }

  state 成功状態 {
    [*] --> 成功モーダル表示
  }

  保存完了 --> 成功状態
}

PhotoImport --> 待機中 : 閉じる

@enduml